{
  "name": "Pirate Captain (Combined)",
  "story": "The player is the captain of The Black Pearl, a legendary pirate ship. The player's crew has just docked at Tortuga, a notorious pirate haven. Adventure and treasure await as the player explores the Caribbean during the Golden Age of Piracy.",
  "rating": "PG-13",
  "narrator_id": "comedic",
  "default_pc": "pirate_captain",
  "locations": {
    "tortuga": {
      "name": "Tortuga",
      "description": "A bustling pirate port filled with taverns, traders, and trouble.",
      "exits": {
        "east": "black_pearl",
        "south": "sleepy_mermaid",
        "west": "tortuga_market"
      },
      "blocked_exits": {
        "north": "Lots of British soldiers in northern docks."
      }
    },
    "black_pearl": {
      "name": "Black Pearl",
      "description": "The player's ship, moored at the docks, ready for the next voyage. ",
      "exits": {
        "west": "tortuga",
        "cabin door": "captains_cabin",
        "open sea": "open_sea"
      },
      "items": [
        "ship repair ledger",
        "billy the parrot"
      ]
    },
    "captains_cabin": {
      "name": "Captain's Cabin",
      "description": "The player's personal quarters on the ship, filled with maps and treasures.",
      "exits": {
        "cabin door": "black_pearl"
      },
      "items": [
        "bag of pieces of eight",
        "bag of gems",
        "map of the Caribbean",
        "letter from Calypso"
      ]
    },
    "sleepy_mermaid": {
      "name": "Sleepy Mermaid",
      "description": "A rowdy inn filled with pirates and rumors of treasure. Calypso serves drinks and shares tales of the sea. The shipwright sits at a corner table, sketching designs for ship repairs and scowling. ",
      "exits": {
        "north": "tortuga",
        "back door": "tortuga_market"
      }
    },
    "tortuga_market": {
      "name": "Tortuga Market",
      "description": "A bustling market filled with merchants, pirates, and rare goods. The air is thick with the scent of spices and the sound of haggling.",
      "exits": {
        "main street": "tortuga",
        "Sleepy Mermaid back door": "sleepy_mermaid"
      },
      "items": [
        "forged documents",
        "rare spices"
      ]
    },
    "open_sea": {
      "name": "Open Sea",
      "description": "The vast and treacherous waters of the Caribbean, certain death for an unrepaired ship.",
      "blocked_exits": {
        "tortuga": "Once it departs, the Pearl is deteriorating too quickly to return to port."
      }
    }
  },
  "npcs": {
    "gibbs": {
      "name": "Gibbs",
      "type": "pirate",
      "disposition": "loyal",
      "description": "The player's loyal first mate with a keen sense of duty.",
      "location": "black_pearl",
      "items": []
    },
    "calypso": {
      "name": "Calypso",
      "type": "bartender",
      "disposition": "friendly but mysterious",
      "description": "A bartender at the Sleepy Mermaid, known for her enchanting stories and elusive nature. Speaks with a Haitian accent.",
      "location": "sleepy_mermaid",
      "items": [
        "flagon of ale",
        "deck of cards"
      ]
    },
    "charming_danny": {
      "name": "Charming Danny",
      "type": "merchant",
      "disposition": "shrewd and cunning",
      "description": "A merchant who deals in common items necessary for life at sea. Unpleasant smell and unpleasant demeanor, but has what the player needs. He owes a debt to the player, but is loath to repay it. With some persuasion, he will eventually give any of his wares to the player.",
      "location": "tortuga_market",
      "items": [
        "forged documents",
        "rare spices",
        "bottle of rum",
        "black powder",
        "flintlock pistol"
      ]
    },
    "shipwright": {
      "name": "Shipwright",
      "type": "shipwright",
      "disposition": "gruff but helpful",
      "description": "A burly shipwright who will repair the player's ship. He requires a ship repair ledger to begin the work, and a payment of 500 gold doubloons to complete the repairs.",
      "location": "sleepy_mermaid",
      "items": []
    }
  },
  "scenes": {
    "shipwright": {
      "story": "The player's ship badly needs repairs. The player must identify this problem and find the shipwright to hire him to fix The Black Pearl.",
      "locations": {},
      "npcs": {},
      "contingency_prompts": [
        "When the player boards the black pearl, if the repair ledger is not in inventory, mention the repair ledger when describing the ship's condition. (The ledger is on deck, and not in the cabin.)",
        "The shipwright can BEGIN work for a small deposit. To FINISH the repairs, he requires payment of 500 gold doubloons.",
        "The player may attempt to sail the Black Pearl without completing repairs, although the game will end badly.",
        "Calypso is the bartender at the Sleepy Mermaid. She greets her customers with a warm smile and a hint of mystery."
      ],
      "contingency_rules": [
        "When the shipwright starts repairs, the scene changes to 'british_docks'.",
        "If the shipwright has previously agreed to start repairs, the scene changes to 'british_docks'.",
        "When the shipwright agrees to start repairs, set the variable \"shipwright_hired\" to \"true\".",
        "Reading the ship repair ledger adds it to inventory and sets the variable \"ship_repair_ledger_acquired\" to \"true\". Observing that it is on the ship does not.",
        "Showing the ship repair ledger to the shipwright removes it from the player's inventory.",
        "If the Black Pearl leaves Tortuga in disrepair, the ship sinks and the game ends."
      ],
      "vars": {
        "ship_repair_ledger_acquired": "false",
        "shipwright_hired": "false"
      },
      "conditionals": {
        "hire_shipwright_transition": {
          "when": {
            "vars": {"shipwright_hired": "true"}
          },
          "then": {"scene": "british_docks"}
        }
      }
    },
    "british_docks": {
      "story": "The player needs gold to pay the shipwright. The British Docks hold a chest of gold doubloons, but it's heavily guarded territory. The player will need to use cunning and disguise to steal the treasure.",
      "locations": {
        "tortuga": {
          "name": "Tortuga",
          "description": "A bustling pirate port filled with taverns, traders, and trouble.",
          "exits": {
            "east": "black_pearl",
            "south": "sleepy_mermaid",
            "north": "british_docks",
            "west": "tortuga_market"
          }
        },
        "british_docks": {
          "name": "British Docks",
          "description": "A heavily guarded area where British ships are docked.",
          "exits": {
            "south": "tortuga"
          },
          "items": [
            "wanted poster with a handsome scoundrel's face",
            "chest of 510 gold doubloons",
            "british naval uniform"
          ]
        },
        "sleepy_mermaid": {
          "name": "Sleepy Mermaid",
          "description": "A rowdy inn, empty but for a few patrons. Calypso is trying to close up for the night.",
          "exits": {
            "north": "tortuga",
            "back door": "tortuga_market"
          }
        }
      },
      "npcs": {
        "davey": {
          "name": "Davey",
          "type": "pirate",
          "disposition": "friendly",
          "description": "A grizzled old pirate with a wooden leg. Fellow captain and sometimes ally.",
          "important": false,
          "location": "tortuga_market",
          "items": []
        }
      },
      "contingency_prompts": [
        "The British docks are not easy to access. The player must use cunning and disguise.",
        "The player should be advised to make a plan, gather resources, and get some minions and allies to help.",
        "British naval uniforms and forged documents could be useful for infiltrating the British Docks.",
        "The shipwright is now located in the Black Pearl, working on repairs. He does not like to be bothered at a time like this."
      ],
      "contingency_rules": [
        "When the player has returned to the Black Pearl and paid the shipwright 500 gold, the scene changes to 'calypsos_map'.",
        "If the player has previously paid the shipwright 500 gold, the scene changes to 'calypsos_map'.",
        "When the player has returned to the Black Pearl and paid the shipwright 500 gold, set the variable \"shipwright_paid_in_full\" to \"true\".",
        "If the player is caught stealing at the British Docks without proper disguise, they are captured and the game ends with imprisonment.",
        "If the player attacks British guards directly, the player is overwhelmed and captured and the game ends with imprisonment."
      ],
      "vars": {
        "disguise_acquired": "false",
        "docks_accessed": "false",
        "gold_acquired": "false",
        "shipwright_paid_in_full": "false"
      },
      "conditionals": {
        "british_docks_to_calypsos_map": {
          "when": {
            "vars": {"shipwright_paid_in_full": "true"}
          },
          "then": {"scene": "calypsos_map"}
        }
      }
    },
    "calypsos_map": {
      "story": "With gold in hand, the player can pay the shipwright. But Calypso has something special for the player - a treasure map that will lead to even greater riches. The player must complete their business and claim the map. The hour is late, and the streets are quiet.",
      "locations": {
        "tortuga": {
          "name": "Tortuga",
          "description": "A bustling pirate port, closed down for the night. Shadows flicker in the alleys. ",
          "exits": {
            "east": "black_pearl",
            "south": "sleepy_mermaid"
          },
          "blocked_exits": {
            "north": "Nothing useful for pirates in the British Docks.",
            "west": "Tortuga Market, closed"
          }
        },
        "sleepy_mermaid": {
          "name": "Sleepy Mermaid",
          "description": "A rowdy inn, empty but for a few patrons. Calypso is trying to close up for the night.",
          "exits": {
            "north": "tortuga",
            "back door": "tortuga_market"
          }
        }
      },
      "npcs": {
        "calypso": {
          "name": "Calypso",
          "type": "bartender",
          "disposition": "teasing and tricky",
          "description": "A bartender at the Sleepy Mermaid, known for her enchanting stories and elusive nature. She has a special treasure map for the player.",
          "important": true,
          "location": "sleepy_mermaid",
          "items": [
            "treasure map",
            "flagon of ale",
            "deck of cards"
          ]
        }
      },
      "vars": {
        "treasure_map_acquired": "false",
        "pearl_departed_tortuga": "false"
      },
      "contingency_prompts": [
        "Calypso will only give the treasure map to someone she trusts - someone who has proven themselves worthy.",
        "The treasure map leads to Dead Man's Cove, but rival pirates may also be seeking the same treasure.",
        "The Black Pearl is now seaworthy and ready for the final adventure.",
        "The shipwright does not participate in this part of the adventure."
      ],
      "contingency_rules": [
        "When the player commands the crew to sail, set sail, weigh anchor, depart, or leave Tortuga (or uses the 'open sea' exit from the Black Pearl), set the variable \"pearl_departed_tortuga\" to \"true\".",
        "When the player commands the crew to sail, set sail, weigh anchor, depart, or leave Tortuga (or uses the 'open sea' exit from the Black Pearl), the game ends."
      ],
      "conditionals": {
        "end_game_on_departure": {
          "when": {
            "vars": {"pearl_departed_tortuga": "true"}
          },
          "then": {"game_ended": true}
        }
      }
    }
  },
  "opening_scene": "shipwright",
  "opening_prompt": "%s\n\nYou stand on the bustling docks of Tortuga, the salty air thick with the promise of adventure. Your ship needs repairs before you can set sail again. What will you do next?",
  "opening_location": "tortuga",
  "opening_inventory": [
    "cutlass",
    "spyglass",
    "lockpicks"
  ],
  "contingency_prompts": [
    "Use some humor in responses.",
    "Encourage the player to embrace their villainous and piratical nature.",
    "If stuck, the player should consult Calypso.",
    "Calypso does not reciprocate flirtation."
  ],
  "game_end_prompt": "Weigh anchor and evaluate the player's pirate career! Rate their performance using with humor. Consider cunning, speed, treasure acquired, and whether they lived up to the pirate code. Give them a proper pirate sendoff with humor and maritime flair!"
}
