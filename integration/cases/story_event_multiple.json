{
  "name": "Story Event Multiple Events Test",
  "description": "Tests that multiple story events can be queued and fired together in the same turn",
  "scenario": "dracula-story-events.json",
  "seed_game_state": {
    "scene_name": "arrival",
    "user_location": "library",
    "turn_counter": 1,
    "scene_turn_counter": 1,
    "user_inventory": [
      "wooden stakes",
      "silver cross",
      "holy water"
    ],
    "vars": {
      "opened_grimoire": "false",
      "dracula_appeared": "false"
    },
    "chat_history": [
      {
        "role": "user",
        "content": "I walk through the gates and enter the castle, heading directly to the library."
      },
      {
        "role": "assistant",
        "content": "You push through the iron gates and quickly navigate through the Grand Foyer to the library. Towering bookshelves filled with ancient tomes reach up to the vaulted ceiling. The ancient grimoire rests prominently on a reading table in the center."
      }
    ]
  },
  "steps": [
    {
      "name": "Open grimoire (queues two story events for next turn)",
      "user_prompt": "I open the ancient grimoire and begin reading.",
      "expect": {
        "scene_name": "arrival",
        "user_location": "library",
        "vars": {
          "opened_grimoire": "true"
        }
      }
    },
    {
      "name": "Both story events fire together",
      "user_prompt": "I continue reading the grimoire intently.",
      "expect": {
        "scene_name": "arrival",
        "user_location": "library",
        "vars": {
          "opened_grimoire": "true"
        },
        "response_contains": [
          "Dracula",
          "bat"
        ]
      }
    },
    {
      "name": "Events do not repeat (one-time use)",
      "user_prompt": "I put down the grimoire and look around nervously.",
      "expect": {
        "scene_name": "arrival",
        "user_location": "library",
        "vars": {
          "opened_grimoire": "true"
        }
      }
    }
  ]
}
